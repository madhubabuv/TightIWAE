from pylab import plt
from utils import *
import numpy as np

log_path = "logs/log_MIVAE_M4_k16.h5"

metrics_iwae_k, metrics_iwae_64, metrics_iwae_5000 = load_from_h5(log_path)


metrics_iwae_k =  [100.60017, 97.495316, 93.73036, 93.94786, 94.5732, 92.729355, 93.425125, 90.291374, 93.78612, 90.49359, 92.21967, 90.90826, 92.679825, 92.02511, 90.798416, 89.559105, 90.00381, 90.81752, 89.881, 89.8387, 90.91886, 90.204346, 91.07052, 92.61169, 92.584274, 91.39553, 90.45544, 88.39308, 88.659195, 89.660805, 91.774925, 89.531784, 92.50008, 91.06313, 90.29524, 91.061325, 90.30444, 90.20936, 86.72357, 90.04259, 90.310196, 89.504845, 89.62296, 89.968834, 89.21645, 88.88422, 90.35419, 90.24618, 91.36249, 89.90922, 90.95548, 89.08443, 89.806076, 90.33095, 89.60091, 90.49624, 89.84548, 91.21112, 89.66018, 89.206116, 91.19822, 90.67192, 88.838104, 90.80796, 91.32182, 90.339615, 89.62119, 88.35066, 89.66268, 89.081375, 89.00643, 88.62465, 91.70122, 90.68244, 89.09955, 88.664444, 89.476364, 88.61057, 90.50607, 91.06748, 90.50459, 90.47566, 87.46558, 90.22849, 92.39268, 90.25658, 90.03987, 91.224205, 89.06687, 89.6198, 87.60958, 90.32, 88.540634, 88.31256, 91.34196, 91.4578, 92.9583, 92.09793, 89.99465, 91.01882, 91.07701, 86.22732, 90.296646, 89.082664]
metrics_iwae_64 =  [102.15035, 97.28275, 95.597275, 95.01338, 94.68193, 93.13754, 92.51217, 91.06625, 92.70471, 91.28606, 92.32814, 90.31432, 91.84232, 91.27211, 90.56996, 89.93095, 90.396324, 91.3627, 90.35997, 90.10158, 91.01424, 91.00814, 90.65215, 91.081085, 91.45149, 91.56163, 89.86934, 90.02996, 89.12636, 90.15038, 89.68653, 89.8241, 90.83826, 90.41073, 90.18132, 91.468895, 90.41524, 90.031715, 89.63045, 90.35454, 90.551186, 90.78813, 90.48448, 89.80445, 89.5303, 89.842606, 90.72389, 89.322556, 91.51677, 89.809326, 89.57092, 89.371506, 90.438515, 90.06029, 89.25814, 90.48818, 90.24875, 90.20928, 89.94159, 90.43138, 90.0655, 89.43281, 90.20007, 90.0818, 89.908585, 90.1771, 90.49945, 90.898605, 90.95469, 89.60382, 89.989525, 89.908, 90.3475, 89.435814, 90.29283, 90.61048, 90.06348, 89.03506, 90.33092, 89.90314, 91.00169, 90.68418, 89.96599, 90.12129, 90.52034, 89.42717, 90.07274, 90.27251, 90.54059, 90.41249, 89.31515, 89.50169, 89.258934, 89.34949, 91.143906, 91.09599, 90.00443, 90.44269, 89.96842, 90.09192, 91.30989, 89.373215, 90.44566, 90.77617]
metrics_iwae_5000 =  [102.1007, 97.621, 95.63915, 94.58991, 93.83725, 93.42162, 92.97651, 92.36621, 92.154976, 91.89781, 91.76494, 91.55704, 91.369, 91.47145, 91.224785, 90.93836, 90.961754, 91.09636, 90.95743, 90.685974, 90.74491, 90.77034, 90.89453, 90.6669, 90.9246, 90.757965, 90.40145, 90.451515, 90.46358, 90.56141, 90.407684, 90.419495, 90.30972, 90.47091, 90.76079, 90.450455, 90.45166, 90.546844, 90.39075, 90.460045, 90.396095, 90.51855, 90.23269, 90.216125, 90.290405, 90.17742, 90.45745, 90.3313, 90.25581, 90.38525, 90.19889, 90.37, 90.1647, 90.3585, 90.26193, 90.20015, 90.31274, 90.18764, 90.0443, 90.21192, 90.15902, 90.33676, 90.20395, 90.20013, 90.28789, 89.97834, 90.087776, 90.53953, 89.96233, 90.12239, 90.014786, 90.15052, 90.32825, 90.13418, 90.29075, 90.14708, 90.218155, 89.87199, 90.15511, 90.13471, 90.183304, 90.19396, 90.125145, 90.16792, 89.9848, 90.284386, 90.130585, 89.9561, 90.24812, 90.08786, 90.20451, 90.11454, 90.189865, 89.98401, 89.96369, 90.071915, 90.062546, 90.072266, 90.238396, 90.13815, 90.01382, 90.2581, 90.13695, 90.34932]

metrics_iwae_64 = np.asarray(metrics_iwae_64) * -1

### Figure 5 reconstruction

plt.figure()
plt.plot(metrics_iwae_64, label = "MIWAE M=4, k=16")

plt.legend()
plt.show()